steps:
- name: gcr.io/$PROJECT_ID/buildenv:32
  args: ["bash", "/workspace/scripts/bootstrap.sh"]
- name: gcr.io/$PROJECT_ID/buildenv:32
  args: ["ninja", "-C", "/workspace/build", "-k", "100"]
- name: gcr.io/$PROJECT_ID/buildenv:64
  args: ["bash", "/workspace/scripts/bootstrap.sh"]
  waitFor: ["-"]
- name: gcr.io/$PROJECT_ID/buildenv:64
  args: ["ninja", "-C", "/workspace/build", "-k", "100"]
artifacts:
  objects:
    location: gs://v3dvk-build-results
    paths:
    - /workspace/build/src/broadcom/vulkan/libvulkan_broadcom.so
    - /workspace/build/src/broadcom/vulkan/dev_icd.armv7hl.json
    - /workspace/build/meson-logs/meson-log.txt
options:
  machineType: N1_HIGHCPU_32
